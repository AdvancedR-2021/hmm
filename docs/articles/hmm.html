<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hidden Markov Models • hmm</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Hidden Markov Models">
<meta property="og:description" content="hmm">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hmm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/hmm.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Hidden Markov Models</h1>
            
      
      
      <div class="hidden name"><code>hmm.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="theoretical-background">Theoretical Background<a class="anchor" aria-label="anchor" href="#theoretical-background"></a>
</h2>
<p>Hidden Markov models (HMM’s) constitute a class of statistical models, where we assume that each observed variable (or emission) <span class="math inline">\(\mathsf{X}_1,\mathsf{X}_2,\ldots,\mathsf{X}_n\)</span> depends on latent, unobserved variables <span class="math inline">\(\mathsf{C}_1,\mathsf{C}_2,\ldots,\mathsf{C}_n\)</span>, where these unobserved variables constitute a Markov chain on the finite state space <span class="math inline">\(\{1, 2, \ldots, m\}\)</span> for some <span class="math inline">\(m\in \mathbb{N}\)</span>.</p>
<p>This is useful for modelling a time or sequence dependence of the observed variables. For example, one might consider the number of customers arriving in a store at given time intervals as the observed emissions, where the underlying hidden states would then describe the general ``level of busyness’’ (here, it might be more appropriate with an inhomogeneous Markov chain, but we digress).</p>
<p>As such, in a hidden Markov model, we have that <span class="math inline">\(\mathsf{X}_i\mid \mathsf{C}_i=j\sim \mathbb{P}_j\)</span> for some set of distributions <span class="math inline">\(\{\mathbb{P}_1,\mathbb{P}_2,\ldots,\mathbb{P}_m\}\)</span>. Most commonly, these distributions are all parametric, and usually from the same distribution family (e.g. normal, Poisson etc.), but with different parameters.</p>
<p>We therefore desire a method for estimating these parameters along with the parameters of the Markov chain <span class="math inline">\(\{\mathsf{C}_1,\mathsf{C}_2,\ldots,\mathsf{C}_n\}\)</span>, i.e. the transition probabilities and the initial distribution (the distribution vector of <span class="math inline">\(\mathsf{C}_1\)</span>). As is often the case when working with latent data, the EM-algorithm is very applicable here. In particular, the log-likelihood of the complete data set (including the latent unobserved data) is of the form <span class="math display">\[
    \ell(\delta, \Gamma, \{\theta_i\}_{i=1}^m\mid x, c)
    =A(\delta)+B(\Gamma)+\sum_{i=1}^{m}\sum_{j=1}^{n}\log f_i(x_j\mid\theta_i)1_{\{c_j=i\}}.
\]</span> Here, <span class="math inline">\(\delta\)</span> and <span class="math inline">\(\Gamma\)</span> denote the distribution vector of <span class="math inline">\(\mathsf{C}_1\)</span> and the transition probability matrix, respectively. Their optimization is very general and not very relevant to the use of this package, so we skip the details here. Finally, <span class="math inline">\(f_i(\cdot\mid\theta_i)\)</span> denotes the density of <span class="math inline">\(\mathbb{P}_i\)</span> with the parameter <span class="math inline">\(\theta_i\)</span>.</p>
<p>Replacing the terms in this log-likelihood depending on the latent data with their conditional expectations given the observed data and some other set of parameters, we arrive at the conclusion that in order to maximize the likelihood, we must maximize <span class="math display">\[
    \sum_{j=1}^{n}\log f_i(x_j\mid\theta_i)\mathbb{P}_{\theta'}(\mathsf{C}_j=i\mid \mathsf{X}_k=x_k\text{ for }k=1,2,\ldots,n)
\]</span> with respect to <span class="math inline">\(\theta_i\)</span> for each <span class="math inline">\(i=1,2,\ldots,m\)</span>. In this package (when not using predefined distribution families), this amounts to specifying functions <span class="math inline">\(M_i\)</span>, which given <span class="math inline">\((x_1, u_1),(x_2, u_2),\ldots,(x_n, u_n)\)</span> where <span class="math inline">\(u_k\in[0, 1]\)</span> for all <span class="math inline">\(k\)</span> returns the value of <span class="math inline">\(\theta_i\)</span> maximizing <span class="math display">\[
    \sum_{j=1}^{n}\log f_i(x_j\mid\theta)u_j.
\]</span> If <span class="math inline">\(M_1=M_2=\cdots=M_m:=M\)</span> (such as in the case of different distributions from the same parametric family), supplying just <span class="math inline">\(M\)</span> is sufficient.</p>
</div>
<div class="section level2">
<h2 id="description-and-reasoning-of-the-package-structure">Description and reasoning of the package structure<a class="anchor" aria-label="anchor" href="#description-and-reasoning-of-the-package-structure"></a>
</h2>
<p>In this package, we strive to implement the most important methods for modelling and fitting HMM’s in a way that is sensible for most seasoned <code>R</code>-users. In particular, we aim to mimic the <code>lm</code> function from the <code>stats</code> package, where calling the functions defines a certain <code>S3</code>-object which then has methods for many of the generic functions in <code>R</code>. The hope here being that users will only have to familiarize themselves with the syntax of this one function and utilizing the familiar generic functions for all other aspects.</p>
<p>As such, this package only introduces one “new” function: <code>hmm</code>. Calling this will initialize a new instance of the <code>hmm</code>-class with various attributes. If data is supplied, and estimation is desired, the function will automatically find approximate maximum likelihood estimates using the EM-algorithm as described above.</p>
<p>Finally, in order to make the <code>hmm</code> function as user friendly as possible, there are several built-in common distributions to choose from, which hopefully cover many use-cases.</p>
</div>
<div class="section level2">
<h2 id="examples-of-use">Examples of use<a class="anchor" aria-label="anchor" href="#examples-of-use"></a>
</h2>
<div class="section level4">
<h4 id="basic-fitting-of-a-hidden-markov-model">Basic fitting of a hidden Markov model<a class="anchor" aria-label="anchor" href="#basic-fitting-of-a-hidden-markov-model"></a>
</h4>
<p>Consider the data-set <code>quakes</code> consisting of the number of significant earthquakes (magnitude <span class="math inline">\(7\)</span> or higher) in each year between 1900 and 2006. This is a prime candidate for fitting to a HMM, as it appears as though there are periods of high and low geological activity. It seems a fitting model since we have count data that each observation should have a Poisson distribution, i.e. we fit the model <span class="math display">\[
  \mathsf{X}_j\mid\mathsf{C}_j=i\sim\mathrm{Poisson}(\lambda_i),\quad i=1,\ldots,m, \quad j=1,\ldots,n.
\]</span> Fitting it in <code>R</code> using this package is easy:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load package and data</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">hmm</span><span class="op">)</span>
<span class="va">quakes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span><span class="st">"http://www.hmms-for-time-series.de/second/data/earthquakes.txt"</span><span class="op">)</span><span class="op">$</span><span class="va">V2</span>

<span class="co"># Define initial values for all parameters involved to be used in the EM-algo</span>
<span class="va">Gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">0.1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.9</span><span class="op">)</span><span class="op">)</span>
<span class="va">delta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>
<span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">30</span><span class="op">)</span>

<span class="co"># Fit model</span>
<span class="va">hmm.EQ</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hmm.html">hmm</a></span><span class="op">(</span><span class="va">quakes</span>, <span class="va">Gamma</span>, <span class="va">delta</span>, dist<span class="op">=</span><span class="st">'poisson'</span>, lambda<span class="op">=</span><span class="va">lambda</span><span class="op">)</span></code></pre></div>
<p>To evaluate, we may first look at a summary and plots</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Print summary</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">hmm.EQ</span><span class="op">)</span>
<span class="co">#&gt; Hidden Markov Model with 2 states.</span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;         0%        25%        50%        75%       100% </span>
<span class="co">#&gt; -9.4183026 -3.4183026 -0.4183026  2.5816974 14.9870731 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Initial distribution of Markov chain is:</span>
<span class="co">#&gt; [1] 1 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Transition probability matrix of Markov chain is:</span>
<span class="co">#&gt;           1          2</span>
<span class="co">#&gt; 1 0.9283388 0.07166123</span>
<span class="co">#&gt; 2 0.1189227 0.88107734</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Emission distribution family is poisson with parameters:</span>
<span class="co">#&gt;     lambda</span>
<span class="co">#&gt; 1 15.41830</span>
<span class="co">#&gt; 2 26.01293</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model was fitted using the EM-algorithm in 29 steps.</span>
<span class="co">#&gt; The log-likelihood of the model is -341.8787 and the AIC and BIC are 693.7574 and 707.1216 respectively.</span>
<span class="co"># Make plots</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">hmm.EQ</span>, type<span class="op">=</span><span class="st">'h'</span>, lwd<span class="op">=</span><span class="fl">2</span>, cols<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'tomato'</span>, <span class="st">'steelblue'</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="hmm_files/figure-html/unnamed-chunk-3-1.png" width="700"><img src="hmm_files/figure-html/unnamed-chunk-3-2.png" width="700"><img src="hmm_files/figure-html/unnamed-chunk-3-3.png" width="700"><img src="hmm_files/figure-html/unnamed-chunk-3-4.png" width="700"></p>
<p>We see that our initial estimate guesses were not far off, and the plots seem to decently separate times of high and low geological activity.</p>
<p>We should note, though, that we somewhat arbitrarily chose <span class="math inline">\(m=2\)</span> in this fit. Could we do better with more states? To explore this, we fit for different values of <span class="math inline">\(m\)</span> and plot the AIC and BIC corresponding to each model:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Define function for easily calculating AIC and BIC for each number of states</span>
<span class="va">m_state_model</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">m</span><span class="op">)</span><span class="op">{</span>
  <span class="va">Gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0.1</span>, nrow<span class="op">=</span><span class="va">m</span>, ncol<span class="op">=</span><span class="va">m</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">m</span> <span class="op">*</span> <span class="fl">0.1</span><span class="op">)</span>
  <span class="va">delta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">m</span>, <span class="va">m</span><span class="op">)</span>
  <span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">30</span>, length.out<span class="op">=</span><span class="va">m</span><span class="op">)</span>
  <span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hmm.html">hmm</a></span><span class="op">(</span><span class="va">quakes</span>, <span class="va">Gamma</span>, <span class="va">delta</span>, dist<span class="op">=</span><span class="st">'poisson'</span>, lambda<span class="op">=</span><span class="va">lambda</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">BIC</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="va">m_state_model</span><span class="op">)</span>

<span class="co"># Plot results</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span>, length.out<span class="op">=</span><span class="fl">6</span><span class="op">)</span>, type<span class="op">=</span><span class="st">'n'</span>, xlab<span class="op">=</span><span class="st">'No. of states'</span>, ylab<span class="op">=</span><span class="st">''</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="va">res</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span>, type<span class="op">=</span><span class="st">'b'</span>, col<span class="op">=</span><span class="st">'steelblue'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="va">res</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span>, type<span class="op">=</span><span class="st">'b'</span>, col<span class="op">=</span><span class="st">'tomato'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">'topleft'</span>, legend<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'AIC'</span>, <span class="st">'BIC'</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">1</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'steelblue'</span>, <span class="st">'tomato'</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="hmm_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>It seems as though a model with <span class="math inline">\(m=3\)</span> actually fits better. Fitting this, we find</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Fit model</span>
<span class="va">Gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span>,
               <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.8</span>, <span class="fl">0.1</span><span class="op">)</span>,
               <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span>
<span class="va">delta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">3</span>
<span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">30</span><span class="op">)</span>
<span class="va">hmm.EQ.3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hmm.html">hmm</a></span><span class="op">(</span><span class="va">quakes</span>, <span class="va">Gamma</span>, <span class="va">delta</span>, dist<span class="op">=</span><span class="st">'poisson'</span>, lambda<span class="op">=</span><span class="va">lambda</span><span class="op">)</span>

<span class="co"># Summarize</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">hmm.EQ.3</span><span class="op">)</span>
<span class="co">#&gt; Hidden Markov Model with 3 states.</span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;          0%         25%         50%         75%        100% </span>
<span class="co">#&gt; -11.7116273  -2.7135218   0.2864782   2.2864782  14.2864782 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Initial distribution of Markov chain is:</span>
<span class="co">#&gt; [1] 1 0 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Transition probability matrix of Markov chain is:</span>
<span class="co">#&gt;              1          2          3</span>
<span class="co">#&gt; 1 9.392575e-01 0.03217851 0.02856396</span>
<span class="co">#&gt; 2 4.042751e-02 0.90633291 0.05323958</span>
<span class="co">#&gt; 3 1.881994e-10 0.19042491 0.80957509</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Emission distribution family is poisson with parameters:</span>
<span class="co">#&gt;     lambda</span>
<span class="co">#&gt; 1 13.13366</span>
<span class="co">#&gt; 2 19.71352</span>
<span class="co">#&gt; 3 29.71163</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model was fitted using the EM-algorithm in 16 steps.</span>
<span class="co">#&gt; The log-likelihood of the model is -328.5275 and the AIC and BIC are 679.055 and 708.4561 respectively.</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">hmm.EQ.3</span>, type<span class="op">=</span><span class="st">'h'</span>, lwd<span class="op">=</span><span class="fl">2</span>, cols<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'tomato'</span>, <span class="st">'steelblue'</span>, <span class="st">'purple'</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="hmm_files/figure-html/unnamed-chunk-5-1.png" width="700"><img src="hmm_files/figure-html/unnamed-chunk-5-2.png" width="700"><img src="hmm_files/figure-html/unnamed-chunk-5-3.png" width="700"><img src="hmm_files/figure-html/unnamed-chunk-5-4.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="simulating-data">Simulating data<a class="anchor" aria-label="anchor" href="#simulating-data"></a>
</h4>
<p>Another key part of this package is simulating a variety of HMM’s. This is made easy using the generic <code>simulate</code> function. We first specify a normal HMM (i.e. where all emission distributions are normal) without data, from which we can then simulate.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Specify model</span>
<span class="va">Gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span><span class="op">)</span>,
               <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.8</span> , <span class="fl">0.1</span><span class="op">)</span>,
               <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>  <span class="fl">0</span>, <span class="fl">0.2</span> , <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span>
<span class="va">delta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>
<span class="va">mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span>
<span class="va">sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>
<span class="va">hmm.normal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hmm.html">hmm</a></span><span class="op">(</span><span class="cn">NULL</span>, Gamma<span class="op">=</span><span class="va">Gamma</span>, delta<span class="op">=</span><span class="va">delta</span>, dist<span class="op">=</span><span class="st">'normal'</span>, mean<span class="op">=</span><span class="va">mean</span>, sd<span class="op">=</span><span class="va">sd</span><span class="op">)</span>

<span class="co"># Summarize model</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">hmm.normal</span><span class="op">)</span>
<span class="co">#&gt; Hidden Markov Model with 3 states.</span>
<span class="co">#&gt; Initial distribution of Markov chain is:</span>
<span class="co">#&gt; [1] 1 0 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Transition probability matrix of Markov chain is:</span>
<span class="co">#&gt;     1    2    3</span>
<span class="co">#&gt; 1 0.5 0.25 0.25</span>
<span class="co">#&gt; 2 0.1 0.80 0.10</span>
<span class="co">#&gt; 3 0.0 0.20 0.80</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Emission distribution family is normal with parameters:</span>
<span class="co">#&gt;   mean sd</span>
<span class="co">#&gt; 1    0  1</span>
<span class="co">#&gt; 2    5  1</span>
<span class="co">#&gt; 3   10  1</span>
<span class="co"># Simulate from model</span>
<span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">hmm.normal</span>, nsim<span class="op">=</span><span class="fl">100</span><span class="op">)</span>

<span class="co"># Plot simulation</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">X</span>, pch<span class="op">=</span><span class="fl">20</span>, col<span class="op">=</span><span class="st">'tomato'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="hmm_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>Furthermore, we may also include the hidden states in our simulation for model checking:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Simulate from model</span>
<span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">hmm.normal</span>, nsim<span class="op">=</span><span class="fl">100</span>, include_state<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># Separate into emission and hidden observation</span>
<span class="va">X</span> <span class="op">&lt;-</span> <span class="va">Z</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">]</span>
<span class="va">G</span> <span class="op">&lt;-</span> <span class="va">Z</span><span class="op">[</span><span class="fl">101</span><span class="op">:</span><span class="fl">200</span><span class="op">]</span>

<span class="co"># Plot simulation</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">X</span>, pch<span class="op">=</span><span class="fl">20</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'steelblue'</span>, <span class="st">'tomato'</span>, <span class="st">'purple'</span><span class="op">)</span><span class="op">[</span><span class="va">G</span><span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'steelblue'</span>, <span class="st">'tomato'</span>, <span class="st">'purple'</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="hmm_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="defining-custom-models">Defining custom models<a class="anchor" aria-label="anchor" href="#defining-custom-models"></a>
</h4>
<p>If one wishes to fit/define HMM’s where the emissions are not from one of the included standard distribution families, one can define a custom distribution. To this, one must supply a function (or list of functions) denoting the different densities, a function to generate maximum likelihood estimates (as described in the first section) and a function for generating random observations. We illustrate this with the following two examples, first where all the distributions are from the same parametric family, <span class="math inline">\(\mathbb{P}_i=\mathrm{Uniform}[0, \theta_i]\)</span>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Define custom functions</span>
<span class="va">lls</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">param</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">dunif</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">0</span>, <span class="va">param</span><span class="op">)</span><span class="op">}</span>
<span class="va">lls_mle</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">u</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">}</span>
<span class="va">rdist</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">param</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0</span>, <span class="va">param</span><span class="op">)</span><span class="op">}</span>

<span class="co"># Define remaining parameters</span>
<span class="va">Gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span><span class="op">)</span>,
               <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.8</span> , <span class="fl">0.1</span><span class="op">)</span>,
               <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>  <span class="fl">0</span>, <span class="fl">0.2</span> , <span class="fl">0.8</span><span class="op">)</span><span class="op">)</span>
<span class="va">delta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>
<span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span>

<span class="co"># Define model</span>
<span class="va">hmm.unif</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hmm.html">hmm</a></span><span class="op">(</span><span class="cn">NULL</span>, Gamma<span class="op">=</span><span class="va">Gamma</span>, delta<span class="op">=</span><span class="va">delta</span>, lls<span class="op">=</span><span class="va">lls</span>, param_lls<span class="op">=</span><span class="va">theta</span>, lls_mle<span class="op">=</span><span class="va">lls_mle</span>, rdist<span class="op">=</span><span class="va">rdist</span><span class="op">)</span>

<span class="co"># Summarize model</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">hmm.unif</span><span class="op">)</span>
<span class="co">#&gt; Hidden Markov Model with 3 states.</span>
<span class="co">#&gt; Initial distribution of Markov chain is:</span>
<span class="co">#&gt; [1] 1 0 0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Transition probability matrix of Markov chain is:</span>
<span class="co">#&gt;     1    2    3</span>
<span class="co">#&gt; 1 0.5 0.25 0.25</span>
<span class="co">#&gt; 2 0.1 0.80 0.10</span>
<span class="co">#&gt; 3 0.0 0.20 0.80</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Emission distribution family is custom with parameters:</span>
<span class="co">#&gt;   Param. 1</span>
<span class="co">#&gt; 1        1</span>
<span class="co">#&gt; 2        5</span>
<span class="co">#&gt; 3       10</span>
<span class="co"># Simulate from model</span>
<span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">hmm.unif</span>, nsim<span class="op">=</span><span class="fl">200</span>, include_state<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="va">X</span> <span class="op">&lt;-</span> <span class="va">Z</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">200</span><span class="op">]</span>
<span class="va">G</span> <span class="op">&lt;-</span> <span class="va">Z</span><span class="op">[</span><span class="fl">201</span><span class="op">:</span><span class="fl">400</span><span class="op">]</span>

<span class="co"># Plot simulation</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">X</span>, pch<span class="op">=</span><span class="fl">20</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'steelblue'</span>, <span class="st">'tomato'</span>, <span class="st">'purple'</span><span class="op">)</span><span class="op">[</span><span class="va">G</span><span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'steelblue'</span>, <span class="st">'tomato'</span>, <span class="st">'purple'</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="hmm_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>Finally, we consider a model where the distributions are from two different families, namely where <span class="math inline">\(\mathbb{P}_1=N(0, 1)\)</span> and <span class="math inline">\(\mathbb{P}_2=\mathrm{Exponential}(1)\)</span>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Define custom functions</span>
<span class="va">lls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">param</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">param</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">param</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">}</span>,
            <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">param</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">dexp</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">param</span><span class="op">)</span><span class="op">}</span><span class="op">)</span>

<span class="va">lls_mle</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">u</span><span class="op">)</span><span class="op">{</span><span class="va">mean_hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">u</span><span class="op">*</span><span class="va">x</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">u</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mean_hat</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">u</span><span class="op">*</span><span class="op">(</span><span class="va">x</span><span class="op">-</span><span class="va">mean_hat</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">u</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">}</span>,
                <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">u</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">u</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">u</span><span class="op">*</span><span class="va">x</span><span class="op">)</span><span class="op">}</span><span class="op">)</span>

<span class="va">rdist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">param</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rnorm</span>, args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">param</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">}</span>,
              <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">param</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">param</span><span class="op">)</span><span class="op">}</span><span class="op">)</span>

<span class="co"># Define remaining parameters</span>
<span class="va">Gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.8</span><span class="op">)</span>,
               <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span>
<span class="va">delta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>
<span class="va">param</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,
              <span class="fl">1</span><span class="op">)</span>

<span class="co"># Define model</span>
<span class="va">hmm.mixture</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hmm.html">hmm</a></span><span class="op">(</span><span class="cn">NULL</span>, Gamma<span class="op">=</span><span class="va">Gamma</span>, delta<span class="op">=</span><span class="va">delta</span>, lls<span class="op">=</span><span class="va">lls</span>, param_lls<span class="op">=</span><span class="va">param</span>, lls_mle<span class="op">=</span><span class="va">lls_mle</span>, rdist<span class="op">=</span><span class="va">rdist</span><span class="op">)</span>

<span class="co"># Summarize model</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">hmm.mixture</span><span class="op">)</span>
<span class="co">#&gt; Hidden Markov Model with 2 states.</span>
<span class="co">#&gt; Initial distribution of Markov chain is:</span>
<span class="co">#&gt; [1] 0.5 0.5</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Transition probability matrix of Markov chain is:</span>
<span class="co">#&gt;     1   2</span>
<span class="co">#&gt; 1 0.2 0.8</span>
<span class="co">#&gt; 2 0.8 0.2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Emission distribution family is custom with parameters:</span>
<span class="co">#&gt;   Param. 1 Param. 2</span>
<span class="co">#&gt; 1        0        1</span>
<span class="co">#&gt; 2        1</span>
<span class="co"># Simulate from model</span>
<span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">hmm.mixture</span>, nsim<span class="op">=</span><span class="fl">200</span>, include_state<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="va">X</span> <span class="op">&lt;-</span> <span class="va">Z</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">200</span><span class="op">]</span>
<span class="va">G</span> <span class="op">&lt;-</span> <span class="va">Z</span><span class="op">[</span><span class="fl">201</span><span class="op">:</span><span class="fl">400</span><span class="op">]</span>

<span class="co"># Plot simulation</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">X</span>, pch<span class="op">=</span><span class="fl">20</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'steelblue'</span>, <span class="st">'tomato'</span>, <span class="st">'purple'</span><span class="op">)</span><span class="op">[</span><span class="va">G</span><span class="op">]</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="hmm_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Fit simulated data to model (for fun)</span>
<span class="va">hmm.mixture.fitted</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/hmm.html">hmm</a></span><span class="op">(</span><span class="va">X</span>, Gamma<span class="op">=</span><span class="va">Gamma</span>, delta<span class="op">=</span><span class="va">delta</span>, lls<span class="op">=</span><span class="va">lls</span>, param_lls<span class="op">=</span><span class="va">param</span>, lls_mle<span class="op">=</span><span class="va">lls_mle</span>, rdist<span class="op">=</span><span class="va">rdist</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">hmm.mixture.fitted</span><span class="op">)</span>
<span class="co">#&gt; Hidden Markov Model with 2 states.</span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;         0%        25%        50%        75%       100% </span>
<span class="co">#&gt; -2.9325681 -0.5946432 -0.2437927  0.5659771  3.7752822 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Initial distribution of Markov chain is:</span>
<span class="co">#&gt; [1] 0 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Transition probability matrix of Markov chain is:</span>
<span class="co">#&gt;           1         2</span>
<span class="co">#&gt; 1 0.2178368 0.7821632</span>
<span class="co">#&gt; 2 0.7750314 0.2249686</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Emission distribution family is custom with parameters:</span>
<span class="co">#&gt;     Param. 1 Param. 2</span>
<span class="co">#&gt; 1 0.01063034 1.093135</span>
<span class="co">#&gt; 2 1.28915574         </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Model was fitted using the EM-algorithm in 36 steps.</span>
<span class="co">#&gt; The log-likelihood of the model is -263.7385 and the AIC and BIC are 539.4769 and 559.2668 respectively.</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">hmm.mixture.fitted</span><span class="op">)</span></code></pre></div>
<p><img src="hmm_files/figure-html/unnamed-chunk-9-2.png" width="700"><img src="hmm_files/figure-html/unnamed-chunk-9-3.png" width="700"><img src="hmm_files/figure-html/unnamed-chunk-9-4.png" width="700"><img src="hmm_files/figure-html/unnamed-chunk-9-5.png" width="700"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Asbjørn Holk, Malte Nikolajsen, Leander Tilsted.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.0.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
